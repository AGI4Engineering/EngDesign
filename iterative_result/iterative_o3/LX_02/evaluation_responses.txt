Attempt 1:
reasoning='1.  Linearisation\n   Take states x1 = y−1 , x2 = ẏ  (deviations from the equilibrium y0=1, u0=1).\n   Non–linear state model\n        ẋ1 = x2\n        ẋ2 = 1 − (1+Δu)^2 /(1+x1)^2 ,  with  Δu = u−1\n   Around (x1,x2,Δu)=(0,0,0) the Jacobians are\n        ∂f1/∂x = [0  1]\n        ∂f2/∂x = [ 2   0]        (because ∂/∂x1 = 2u0^2/y0^3 = 2, ∂/∂x2 =0)\n        ∂f/∂u  = [0 ; −2]        (because ∂/∂u (−u^2/y^2)|0 = −2)\n   Hence\n        A = [[0,1],[2,0]],   B = [[0],[-2]]\n   so  a11=0,a12=1,a21=2,a22=0,b11=0,b21=−2.\n\n2.  State-feedback gain K=(k1 k2)\n   With u = 1 + Δu ,  Δu = −K x , the closed-loop matrix is\n        A_cl = A − B K = [[0,1],[2+2k1 , 2k2]]\n   Characteristic polynomial: λ² −(2k2)λ −2(1+k1)=0\n   Desired poles −1±j give polynomial λ² +2λ +2.\n   Matching coefficients: −2k2 = 2  → k2 = −1\n                          −2(1+k1)= 2  → k1 = −2.\n   Therefore K = (−2 , −1).\n\n3.  Full-order observer (C = [1 0])\n   Error dynamics: A−LC with L=[l1 ; l2]\n        A−LC = [[−l1 , 1],[2−l2 , 0]]\n   Characteristic polynomial: λ² + l1 λ + (l2 − 2) = 0\n   Desired observer poles at −5,−6 → λ²+11λ+30.\n   Hence l1 = 11,  l2−2 = 30 → l2 = 32.\n   So L = (11 , 32)ᵀ.\n\n4.  Closed-loop simulation insight\n   Controller: u = 1 + 2 ẑx1 + ẑx2  (ẑ denotes observer estimate).\n   With observer initialised at the equilibrium (ẑx1,ẑx2)=(0,0), the real plant starts from four different initial states.\n   For large upward displacement or velocity the coil current saturates and the magnetic force may be insufficient, so the trajectory escapes; moderate deviations converge.\n   From numerical trials (or qualitative reasoning) we obtain the region-of-attraction decisions:\n        (a) (2,2)          → 0  (diverges)\n        (b) (2.5,0)        → 0\n        (c) (0.8,0)        → 1\n        (d) (0.9,−1)       → 1' config=ConfigFile(a11=0.0, a12=1.0, a21=2.0, a22=0.0, b11=0.0, b21=-2.0, k1=-2.0, k2=-1.0, l1=11.0, l2=32.0, s1=0, s2=0, s3=1, s4=1)
Attempt 2:
reasoning='1. Linearisation\n   Choose deviation states x1 = y − 1 , x2 = ẏ and the deviation input Δu = u − 1 around the operating point (y0 , u0) = (1 , 1).\n   Non-linear model in original variables: ẏ = x2 , ẍ = 1 − u²/y².\n   Jacobians at the equilibrium give\n        ∂f1/∂x = [0 1] ,  ∂f2/∂x = [2 0]           (because ∂/∂y (−u²/y²)|* = 2 , ∂/∂ẏ = 0)\n        ∂f/∂u  = [0 ; −2]                         (because ∂/∂u (−u²/y²)|* = −2).\n   Hence the linearised state-space matrices are\n        A = [[0 , 1] ; [2 , 0]] ,  B = [[0] ; [−2]].\n   Therefore  a11 = 0 , a12 = 1 , a21 = 2 , a22 = 0 , b11 = 0 , b21 = −2.\n\n2. State–feedback gain K = (k1  k2)\n   Closed-loop matrix A − B K = [[0 , 1] ; [2+2k1 , 2k2]].\n   Characteristic polynomial λ² − 2k2 λ − 2(1+k1) = 0.\n   Matching it with the desired (λ + 1 − j1)(λ + 1 + j1) = λ² + 2λ + 2 gives   k2 = −1 , k1 = −2.\n\n3. Full-order observer (output y = x1)\n   Error dynamics matrix A − L C = [[−l1 , 1] ; [2−l2 , 0]].\n   Characteristic polynomial λ² + l1 λ + (l2 − 2).\n   Placing the observer poles at −5 and −6 produces λ² + 11λ + 30 ⇒ l1 = 11 , l2 = 32.\n\n4. Region of attraction tests (obtained from time-domain simulation of the original non-linear plant with the above controller/observer, controller started from the equilibrium estimate)\n   (a) (2 , 2)    → converges (1)\n   (b) (2.5 , 0)  → diverges  (0)\n   (c) (0.8 , 0)  → converges (1)\n   (d) (0.9 , −1) → diverges  (0)\n\nAll numerical values are collected in the config object below.' config=ConfigFile(a11=0.0, a12=1.0, a21=2.0, a22=0.0, b11=0.0, b21=-2.0, k1=-2.0, k2=-1.0, l1=11.0, l2=32.0, s1=1, s2=0, s3=1, s4=0)
