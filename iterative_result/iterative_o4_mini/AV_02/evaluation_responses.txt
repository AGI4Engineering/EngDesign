Attempt 1:
reasoning='We need a narrowband notch filter at 120 Hz with minimal effect at 115 Hz and 125 Hz (|H|>–3 dB) but strong attenuation at 120 Hz (|H|<–40 dB). A second‐order IIR notch (biquad) suffices:\n\n1. Sampling rate fs=2000 Hz, notch f0=120 Hz ⇒ normalized radian freq ω0=2π·120/2000≈0.3770 rad.\n2. Desired 3 dB notch bandwidth ≈10 Hz (from 115 to 125 Hz), so Q=f0/BW=120/10=12.\n3. Pole radius r≈1–(π·BW/fs)=1–(π·10/2000)=0.98429 to set the bandwidth.\n4. Standard notch transfer:\n   H(z)=(1–2cosω0·z⁻¹+z⁻²)/(1–2r\u2009cosω0·z⁻¹+r²\u2009z⁻²).\n5. Compute cosω0≈cos(0.3770)=0.92978. Then:\n   b0=1, b1=–2·0.92978=–1.85956, b2=1\n   a0=1, a1=–2·0.98429·0.92978=–1.83045, a2=(0.98429)²=0.96883\n\nAt ω0 the zeros on the unit circle give infinite theoretical attenuation (>40 dB). At ±5 Hz (ω=2π·115/2000 or 125/2000) the radius r≈0.9843 yields a –3 dB bandwidth ≈10 Hz, satisfying the requirements.' config=ConfigFile(order=2.0, coeffs_numerator=[1.0, -1.85956, 1.0], coeffs_denominator=[1.0, -1.83045, 0.96883])
